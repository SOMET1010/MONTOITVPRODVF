  });`;class F_{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Hu,this.transport=null,this.heartbeatIntervalMs=Io.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ll,this.ref=0,this.reconnectTimer=null,this.logger=Ll,this.conn=null,this.sendBuffer=[],this.serializer=new A_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let s;return i?s=i:typeof fetch>"u"?s=(...o)=>L(async()=>{const{default:a}=await Promise.resolve().then(()=>zi);return{default:a}},void 0).then(({default:a})=>a(...o)).catch(a=>{throw new Error(`Failed to load @supabase/node-fetch: ${a.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...o)=>s(...o)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Wu.websocket}`,this.httpEndpoint=zg(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=b_.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:T_}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case xs.connecting:return pn.Connecting;case xs.open:return pn.Open;case xs.closing:return pn.Closing;default:return pn.Closed}}isConnected(){return this.connectionState()===pn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new cd(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:n,payload:i,ref:s}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(C_,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Io.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:o}=r,a=o?`(${o})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${i} ${a}`.trim(),s),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(i,s,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger($t.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${e}${n}${i}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([$_],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:P_};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push($t.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Mg(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Io.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,i,s,o,a,l,u,c;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:Hu,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:Io.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:Ll,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:h=>U_[h-1]||z_,this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:(h,f)=>f(JSON.stringify(h)),this.decode=(c=e==null?void 0:e.decode)!==null&&c!==void 0?c:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class dd extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ie(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class B_ extends dd{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Qu extends dd{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var V_=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const $g=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>L(async()=>{const{default:n}=await Promise.resolve().then(()=>zi);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},q_=()=>V_(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield L(()=>Promise.resolve().then(()=>zi),void 0)).Response:Response}),Ju=t=>{if(Array.isArray(t))return t.map(r=>Ju(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=Ju(n)}),e},H_=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Mn=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const Dl=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),W_=(t,e,r)=>Mn(void 0,void 0,void 0,function*(){const n=yield q_();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(i=>{const s=t.status||500,o=(i==null?void 0:i.statusCode)||s+"";e(new B_(Dl(i),s,o))}).catch(i=>{e(new Qu(Dl(i),i))}):e(new Qu(Dl(t),t))}),K_=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?i:(H_(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),r))};function so(t,e,r,n,i,s){return Mn(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,K_(e,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>W_(l,a,n))})})}function ja(t,e,r,n){return Mn(this,void 0,void 0,function*(){return so(t,"GET",e,r,n)})}function Gt(t,e,r,n,i){return Mn(this,void 0,void 0,function*(){return so(t,"POST",e,n,i,r)})}function Gu(t,e,r,n,i){return Mn(this,void 0,void 0,function*(){return so(t,"PUT",e,n,i,r)})}function Q_(t,e,r,n){return Mn(this,void 0,void 0,function*(){return so(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Fg(t,e,r,n,i){return Mn(this,void 0,void 0,function*(){return so(t,"DELETE",e,n,i,r)})}var Xe=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const J_={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},rf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class G_{constructor(e,r={},n,i){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=$g(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,i){return Xe(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},rf),i);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(a=Object.assign(Object.assign({},a),i.headers));const u=this._removeEmptyFolders(r),c=this._getFinalPath(u),h=yield(e=="PUT"?Gu:Gt)(this.fetch,`${this.url}/object/${c}`,s,Object.assign({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ie(s))return{data:null,error:s};throw s}})}upload(e,r,n){return Xe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,i){return Xe(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let l;const u=Object.assign({upsert:rf.upsert},i),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield Gu(this.fetch,a.toString(),l,{headers:c});return{data:{path:s,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ie(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return Xe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield Gt(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(this.url+s.url),a=o.searchParams.get("token");if(!a)throw new dd("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ie(n))return{data:null,error:n};throw n}})}update(e,r,n){return Xe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return Xe(this,void 0,void 0,function*(){try{return{data:yield Gt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ie(i))return{data:null,error:i};throw i}})}copy(e,r,n){return Xe(this,void 0,void 0,function*(){try{return{data:{path:(yield Gt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ie(i))return{data:null,error:i};throw i}})}createSignedUrl(e,r,n){return Xe(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield Gt(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ie(i))return{data:null,error:i};throw i}})}createSignedUrls(e,r,n){return Xe(this,void 0,void 0,function*(){try{const i=yield Gt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ie(i))return{data:null,error:i};throw i}})}download(e,r){return Xe(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=s?`?${s}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield ja(this.fetch,`${this.url}/${i}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ie(a))return{data:null,error:a};throw a}})}info(e){return Xe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield ja(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Ju(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ie(n))return{data:null,error:n};throw n}})}exists(e){return Xe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Q_(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ie(n)&&n instanceof Qu){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const a=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${u}`)}}}remove(e){return Xe(this,void 0,void 0,function*(){try{return{data:yield Fg(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}list(e,r,n){return Xe(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},J_),r),{prefix:e||""});return{data:yield Gt(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ie(i))return{data:null,error:i};throw i}})}listV2(e,r){return Xe(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield Gt(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ie(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const Y_="2.12.1",X_={"X-Client-Info":`storage-js/${Y_}`};var Hn=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};class Z_{constructor(e,r={},n,i){this.shouldThrowOnError=!1;const s=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},X_),r),this.fetch=$g(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Hn(this,void 0,void 0,function*(){try{return{data:yield ja(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ie(e))return{data:null,error:e};throw e}})}getBucket(e){return Hn(this,void 0,void 0,function*(){try{return{data:yield ja(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Hn(this,void 0,void 0,function*(){try{return{data:yield Gt(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ie(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return Hn(this,void 0,void 0,function*(){try{return{data:yield Gu(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ie(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Hn(this,void 0,void 0,function*(){try{return{data:yield Gt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Hn(this,void 0,void 0,function*(){try{return{data:yield Fg(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ie(r))return{data:null,error:r};throw r}})}}class e1 extends Z_{constructor(e,r={},n,i){super(e,r,n,i)}from(e){return new G_(this.url,this.headers,e,this.fetch)}}const t1="2.57.4";let us="";typeof Deno<"u"?us="deno":typeof document<"u"?us="web":typeof navigator<"u"&&navigator.product==="ReactNative"?us="react-native":us="node";const r1={"X-Client-Info":`supabase-js-${us}/${t1}`},n1={headers:r1},i1={schema:"public"},s1={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},o1={};var a1=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const l1=t=>{let e;return t?e=t:typeof fetch>"u"?e=jg:e=fetch,(...r)=>e(...r)},u1=()=>typeof Headers>"u"?Pg:Headers,c1=(t,e,r)=>{const n=l1(r),i=u1();return(s,o)=>a1(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let u=new i(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},o),{headers:u}))})};var d1=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};function h1(t){return t.endsWith("/")?t:t+"/"}function f1(t,e){var r,n;const{db:i,auth:s,realtime:o,global:a}=t,{db:l,auth:u,realtime:c,global:h}=e,f={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},c),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=a==null?void 0:a.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>d1(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function p1(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(h1(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Bg="2.71.1",Xn=30*1e3,Yu=3,Ml=Yu*Xn,m1="http://localhost:9999",g1="supabase.auth.token",v1={"X-Client-Info":`gotrue-js/${Bg}`},Xu="X-Supabase-Api-Version",Vg={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},y1=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,w1=10*60*1e3;class hd extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Y(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class _1 extends hd{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function x1(t){return Y(t)&&t.name==="AuthApiError"}class qg extends hd{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class nn extends hd{constructor(e,r,n,i){super(e,n,i),this.name=r,this.status=n}}class Pr extends nn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function S1(t){return Y(t)&&t.name==="AuthSessionMissingError"}class Lo extends nn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Do extends nn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Mo extends nn{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function E1(t){return Y(t)&&t.name==="AuthImplicitGrantRedirectError"}class nf extends nn{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Zu extends nn{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Ul(t){return Y(t)&&t.name==="AuthRetryableFetchError"}class sf extends nn{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class ec extends nn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Pa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),of=` 	
\r=`.split(""),k1=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<of.length;e+=1)t[of[e].charCodeAt(0)]=-2;for(let e=0;e<Pa.length;e+=1)t[Pa[e].charCodeAt(0)]=e;return t})();function af(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Pa[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Pa[n]),e.queuedBits-=6}}function Hg(t,e,r){const n=k1[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function lf(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{P1(o,n,r)};for(let o=0;o<t.length;o+=1)Hg(t.charCodeAt(o),i,s);return e.join("")}function b1(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function j1(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}b1(n,e)}}function P1(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function T1(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)Hg(t.charCodeAt(i),r,n);return new Uint8Array(e)}function C1(t){const e=[];return j1(t,r=>e.push(r)),new Uint8Array(e)}function R1(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};return t.forEach(i=>af(i,r,n)),af(null,r,n),e.join("")}function A1(t){return Math.round(Date.now()/1e3)+t}function O1(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const It=()=>typeof window<"u"&&typeof document<"u",un={tested:!1,writable:!1},Wg=()=>{if(!It())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(un.tested)return un.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),un.tested=!0,un.writable=!0}catch{un.tested=!0,un.writable=!1}return un.writable};function N1(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{e[i]=n}),e}const Kg=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>L(async()=>{const{default:n}=await Promise.resolve().then(()=>zi);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},I1=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Zn=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},cn=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},br=async(t,e)=>{await t.removeItem(e)};let Qg=class Jg{constructor(){this.promise=new Jg.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}};Qg.promiseConstructor=Promise;function zl(t){const e=t.split(".");if(e.length!==3)throw new ec("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!y1.test(e[n]))throw new ec("JWT not in base64url format");return{header:JSON.parse(lf(e[0])),payload:JSON.parse(lf(e[1])),signature:T1(e[2]),raw:{header:e[0],payload:e[1]}}}async function L1(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function D1(t,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await t(s);if(!e(s,null,o)){n(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function M1(t){return("0"+t.toString(16)).substr(-2)}function U1(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,M1).join("")}async function z1(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function $1(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await z1(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wn(t,e,r=!1){const n=U1();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Zn(t,`${e}-code-verifier`,i);const s=await $1(n);return[s,n===s?"plain":"s256"]}const F1=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function B1(t){const e=t.headers.get(Xu);if(!e||!e.match(F1))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function V1(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function q1(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const H1=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Kn(t){if(!H1.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function $l(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function uf(t){return JSON.parse(JSON.stringify(t))}var W1=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const fn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),K1=[502,503,504];async function cf(t){var e;if(!I1(t))throw new Zu(fn(t),0);if(K1.includes(t.status))throw new Zu(fn(t),t.status);let r;try{r=await t.json()}catch(s){throw new qg(fn(s),s)}let n;const i=B1(t);if(i&&i.getTime()>=Vg["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new sf(fn(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Pr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new sf(fn(r),t.status,r.weak_password.reasons);throw new _1(fn(r),t.status||500,n)}const Q1=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function ee(t,e,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Xu]||(s[Xu]=Vg["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const o=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await J1(t,e,r+a,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function J1(t,e,r,n,i,s){const o=Q1(e,n,i,s);let a;try{a=await t(r,Object.assign({},o))}catch(l){throw console.error(l),new Zu(fn(l),0)}if(a.ok||await cf(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(l){await cf(l)}}function ar(t){var e;let r=null;Z1(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=A1(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function df(t){const e=ar(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Nr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function G1(t){return{data:t,error:null}}function Y1(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=t,o=W1(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function X1(t){return t}function Z1(t){return t.access_token&&t.refresh_token&&t.expires_in}const Fl=["global","local","others"];var ex=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class tx{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=Kg(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=Fl[0]){if(Fl.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fl.join(", ")}`);try{return await ee(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await ee(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Nr})}catch(n){if(Y(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=ex(e,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await ee(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Y1,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Y(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await ee(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Nr})}catch(r){if(Y(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,i,s,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},c=await ee(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:X1});if(c.error)throw c.error;const h=await c.json(),f=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(l=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return v.length>0&&(v.forEach(y=>{const w=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(y.split(";")[1].split("=")[1]);u[`${k}Page`]=w}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Y(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Kn(e);try{return await ee(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Nr})}catch(r){if(Y(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Kn(e);try{return await ee(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Nr})}catch(n){if(Y(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Kn(e);try{return await ee(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Nr})}catch(n){if(Y(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Kn(e.userId);try{const{data:r,error:n}=await ee(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Y(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Kn(e.userId),Kn(e.id);try{return{data:await ee(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}}}function hf(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function rx(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Qn={debug:!!(globalThis&&Wg()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Gg extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class nx extends Gg{}async function ix(t,e,r){Qn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Qn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Qn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await r()}finally{Qn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw Qn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new nx(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Qn.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}rx();const sx={url:m1,storageKey:g1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:v1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ff(t,e,r){return await r()}const Jn={};class Vs{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Vs.nextInstanceID,Vs.nextInstanceID+=1,this.instanceID>0&&It()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},sx),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new tx({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Kg(i.fetch),this.lock=i.lock||ff,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:It()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=ix:this.lock=ff,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Wg()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=hf(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=hf(this.memoryStorage)),It()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Jn[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Jn[this.storageKey]=Object.assign(Object.assign({},Jn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Jn[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Jn[this.storageKey]=Object.assign(Object.assign({},Jn[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Bg}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=N1(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),It()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),E1(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Y(r)?{error:r}:{error:new qg("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,i;try{const s=await ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:ar}),{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(Y(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var r,n,i;try{let s;if("email"in e){const{email:c,password:h,options:f}=e;let v=null,y=null;this.flowType==="pkce"&&([v,y]=await Wn(this.storage,this.storageKey)),s=await ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:c,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:v,code_challenge_method:y},xform:ar})}else if("phone"in e){const{phone:c,password:h,options:f}=e;s=await ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:ar})}else throw new Do("You must provide either an email or phone number and a password");const{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(Y(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:o,options:a}=e;r=await ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:df})}else if("phone"in e){const{phone:s,password:o,options:a}=e;r=await ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:df})}else throw new Do("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Lo}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Y(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,i,s,o,a,l,u,c,h,f,v;let y,w;if("message"in e)y=e.message,w=e.signature;else{const{chain:k,wallet:m,statement:p,options:g}=e;let E;if(It())if(typeof m=="object")E=m;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))E=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=m}const P=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const j=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:P.host,uri:P.href}),p?{statement:p}:null));let _;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")_=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)_=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)y=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),w=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${P.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1",`URI: ${P.href}`,`Issued At: ${(i=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=g==null?void 0:g.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((a=g==null?void 0:g.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((u=g==null?void 0:g.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((h=(c=g==null?void 0:g.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||h===void 0)&&h.length?["Resources",...g.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const j=await E.signMessage(new TextEncoder().encode(y),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=j}}try{const{data:k,error:m}=await ee(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:R1(w)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:ar});if(m)throw m;return!k||!k.session||!k.user?{data:{user:null,session:null},error:new Lo}:(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),{data:Object.assign({},k),error:m})}catch(k){if(Y(k))return{data:{user:null,session:null},error:k};throw k}}async _exchangeCodeForSession(e){const r=await cn(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:o}=await ee(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:ar});if(await br(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Lo}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(Y(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:s,nonce:o}=e,a=await ee(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ar}),{data:l,error:u}=a;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Lo}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(r){if(Y(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,i,s,o;try{if("email"in e){const{email:a,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Wn(this.storage,this.storageKey));const{error:h}=await ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:c}=await ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new Do("You must provide either an email or phone number.")}catch(a){if(Y(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,n;try{let i,s;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await ee(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:ar});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(Y(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var r,n,i;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await Wn(this.storage,this.storageKey)),await ee(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:G1})}catch(s){if(Y(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Pr;const{error:i}=await ee(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(Y(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:s}=e,{error:o}=await ee(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:i,options:s}=e,{data:o,error:a}=await ee(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Do("You must provide either an email or phone number and a type")}catch(r){if(Y(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await cn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Ml:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await cn(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=$l()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,c)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,c))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Nr}):await this._useSession(async r=>{var n,i,s;const{data:o,error:a}=r;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Pr}:await ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Nr})})}catch(r){if(Y(r))return S1(r)&&(await this._removeSession(),await br(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Pr;const o=i.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Wn(this.storage,this.storageKey));const{data:u,error:c}=await ee(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Nr});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(Y(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Pr;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:o}=zl(e.access_token);if(o.exp&&(n=o.exp,i=n<=r),i){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Y(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Pr;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Y(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!It())throw new Mo("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Mo(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new nf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Mo("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new nf("No code detected.");const{data:p,error:g}=await this._exchangeCodeForSession(e.code);if(g)throw g;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:p.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=e;if(!s||!a||!o||!u)throw new Mo("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(a);let f=c+h;l&&(f=parseInt(l));const v=f-c;v*1e3<=Xn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${h}s`);const y=f-h;c-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,f,c):c-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,f,c);const{data:w,error:k}=await this._getUser(s);if(k)throw k;const m={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:h,expires_at:f,refresh_token:o,token_type:u,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(n){if(Y(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await cn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{error:s};const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(x1(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await br(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=O1(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Wn(this.storage,this.storageKey,!0));try{return await ee(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Y(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var o,a,l,u,c;const{data:h,error:f}=s;if(f)throw f;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ee(this.fetch,"GET",v,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(i)throw i;return It()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Y(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:o}=r;if(o)throw o;return await ee(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Y(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await D1(async i=>(i>0&&await L1(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await ee(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ar})),(i,s)=>{const o=200*Math.pow(2,i);return s&&Ul(s)&&Date.now()+o-n<Xn})}catch(n){if(this._debug(r,"error",n),Y(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),It()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await cn(this.storage,this.storageKey);if(i&&this.userStorage){let o=await cn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Zn(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:$l()}else if(i&&!i.user&&!i.user){const o=await cn(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await br(this.storage,this.storageKey+"-user"),await Zn(this.storage,this.storageKey,i)):i.user=$l()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ml;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Ml}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Ul(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(i.access_token);!a&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Pr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Qg;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new Pr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={session:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(i,"error",s),Y(s)){const o={session:null,error:s};return Ul(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){s.push(l)}});if(await Promise.all(o),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Zn(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=uf(i);await Zn(this.storage,this.storageKey,s)}else{const i=uf(r);await Zn(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await br(this.storage,this.storageKey),await br(this.storage,this.storageKey+"-code-verifier"),await br(this.storage,this.storageKey+"-user"),this.userStorage&&await br(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&It()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Xn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/Xn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Xn}ms, refresh threshold is ${Yu} ticks`),i<=Yu&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Gg)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!It()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,o]=await Wn(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(a.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await ee(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Y(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:o}=r;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await ee(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Y(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{data:null,error:s};const{data:o,error:a}=await ee(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(Y(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await ee(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Y(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],i=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=zl(i.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const c=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(a=>a.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(a=>a.kid===e),n&&this.jwks_cached_at+w1>i)return n;const{data:s,error:o}=await ee(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(a=>a.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:v,error:y}=await this.getSession();if(y||!v.session)return{data:null,error:y};n=v.session.access_token}const{header:i,payload:s,signature:o,raw:{header:a,payload:l}}=zl(n);r!=null&&r.allowExpired||V1(s.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:s,header:i,signature:o},error:null}}const c=q1(i.alg),h=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,o,C1(`${a}.${l}`)))throw new ec("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}}Vs.nextInstanceID=0;const ox=Vs;class ax extends ox{constructor(e){super(e)}}var lx=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};class ux{constructor(e,r,n){var i,s,o;this.supabaseUrl=e,this.supabaseKey=r;const a=p1(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const l=`sb-${a.hostname.split(".")[0]}-auth-token`,u={db:i1,realtime:o1,auth:Object.assign(Object.assign({},s1),{storageKey:l}),global:n1},c=f1(n??{},u);this.storageKey=(i=c.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=c1(r,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new k_(new URL("rest/v1",a).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new e1(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new r_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return lx(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,storageKey:o,flowType:a,lock:l,debug:u},c,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ax({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),c),storageKey:o,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,flowType:a,lock:l,debug:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new F_(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const cx=(t,e,r)=>new ux(t,e,r);function dx(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}dx()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const hx="https://muiidvzmpcmcmrxuwtqt.supabase.co",fx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im11aWlkdnptcGNtY21yeHV3dHF0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQwNDQzMDgsImV4cCI6MjA3OTYyMDMwOH0.WURqe9zpb_hSZyJrHOXswxEkByungk_U1fYGeqfLJag",fe=cx(hx,fx,{auth:{persistSession:!0,autoRefreshToken:!0}});async function Yg(){try{const t=new Promise((n,i)=>setTimeout(()=>i(new Error("Connection timeout after 5 seconds")),5e3)),e=fe.from("profiles").select("id").limit(1),{error:r}=await Promise.race([e,t]);return r?r.message.includes("schema cache")||r.message.includes("Could not find")?{success:!1,message:"La table des profils n'est pas accessible. Les migrations de base de donnes n'ont peut-tre pas t appliques correctement."}:{success:!1,message:r.message}:{success:!0,message:"Database connection successful"}}catch(t){return t.message.includes("timeout")?{success:!1,message:"La connexion a expir. Vrifiez votre connexion Internet."}:t.message.includes("schema cache")||t.message.includes("Could not find")?{success:!1,message:"La table des profils n'est pas accessible. Les migrations de base de donnes n'ont peut-tre pas t appliques correctement."}:{success:!1,message:t.message}}}class px{constructor(){Vn(this,"isDevelopment",!1);Vn(this,"isProduction",!0)}formatMessage(e){const r=[`[${e.timestamp}]`,`[${e.level.toUpperCase()}]`,e.message];return e.context&&r.push(JSON.stringify(e.context)),r.join(" ")}createEntry(e,r,n,i){return{level:e,message:r,timestamp:new Date().toISOString(),context:n,error:i}}shouldLog(e){return this.isDevelopment?!0:this.isProduction?e==="warn"||e==="error":!1}debug(e,r){if(!this.shouldLog("debug"))return;const n=this.createEntry("debug",e,r);console.debug(this.formatMessage(n),r)}info(e,r){if(!this.shouldLog("info"))return;const n=this.createEntry("info",e,r);console.info(this.formatMessage(n),r)}warn(e,r){if(!this.shouldLog("warn"))return;const n=this.createEntry("warn",e,r);console.warn(this.formatMessage(n),r),this.isProduction&&window.Sentry&&window.Sentry.captureMessage(e,{level:"warning",extra:r})}error(e,r,n){if(!this.shouldLog("error"))return;const i=this.createEntry("error",e,n,r);console.error(this.formatMessage(i),r,n),this.isProduction&&window.Sentry&&(r?window.Sentry.captureException(r,{extra:{message:e,...n}}):window.Sentry.captureMessage(e,{level:"error",extra:n}))}group(e){this.isDevelopment&&console.group(e)}groupEnd(){this.isDevelopment&&console.groupEnd()}}const Uo=new px,Xg=x.createContext(void 0);function mx({children:t}){const[e,r]=x.useState(null),[n,i]=x.useState(null),[s,o]=x.useState(null),[a,l]=x.useState(!0),[u,c]=x.useState(null);x.useEffect(()=>{fe.auth.getSession().then(({data:{session:j}})=>{o(j),r((j==null?void 0:j.user)??null),j!=null&&j.user?h(j.user.id):l(!1)});const{data:{subscription:P}}=fe.auth.onAuthStateChange((j,_)=>{(async()=>(o(_),r((_==null?void 0:_.user)??null),_!=null&&_.user?await h(_.user.id):(i(null),l(!1))))()});return()=>P.unsubscribe()},[]);const h=async(P,j=0)=>{try{if(Uo.debug("Loading user profile",{userId:P,attempt:j+1,maxRetries:6}),j===0){const W=await Yg();if(!W.success){Uo.error("Database connection failed",void 0,{message:W.message}),c({type:"network",message:"Problme de connexion  la base de donnes",details:W.message}),l(!1);return}}const{data:z,error:A}=await fe.from("profiles").select("*").eq("id",P).maybeSingle();if(A){if(Uo.error("Error loading profile from Supabase",A,{userId:P}),A.message.includes("schema cache")||A.message.includes("Could not find the table")){Uo.error("Schema cache error - profiles table not accessible",void 0,{userId:P}),c({type:"database",message:"Connexion  la base de donnes impossible",details:`Could not find the table 'public.profiles' in the schema cache
 PRIORIT ABSOLUE : La scurit de l'utilisateur passe AVANT tout !`},...r.slice(-10).map(u=>({role:u.role,content:u.content})),{role:"user",content:e}],a=await fetch("https://muiidvzmpcmcmrxuwtqt.supabase.co/functions/v1/ai-chatbot",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im11aWlkdnptcGNtY21yeHV3dHF0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQwNDQzMDgsImV4cCI6MjA3OTYyMDMwOH0.WURqe9zpb_hSZyJrHOXswxEkByungk_U1fYGeqfLJag"},body:JSON.stringify({messages:s,userId:n,temperature:.8,maxTokens:1e3})});if(!a.ok){const u=await a.json().catch(()=>({}));throw console.error("Edge function error:",u),new Error(u.error||"Failed to get AI response")}const l=await a.json();return console.log(" AI Response received successfully from edge function"),l.content}catch(i){return console.error(" Error getting AI response:",i),console.log(" Using intelligent fallback system"),this.getFallbackResponse(e)}}getFallbackResponse(e){const r=e.toLowerCase();return this.detectScam(r)?this.getScamWarningResponse(r):r.includes("recherche")||r.includes("proprit")?` **Pour rechercher une proprit SCURISE** :
Comment puis-je vous aider aujourd'hui ? `,created_at:new Date().toISOString()};n([ke]),h(!0)}else h(!1)}},j=async M=>{var st;const ie=M||i.trim();if(!ie||!l||!p)return;s(""),a(!0),h(!1);const ke=await sr.sendMessage(l.id,ie,"user");ke&&n(ot=>[...ot,ke]);try{const ot=await sr.getAIResponse(ie,r,p.id),at=await sr.sendMessage(l.id,ot,"assistant");at&&n(I=>[...I,at])}catch(ot){console.error("Error getting AI response:",ot);const at=await sr.sendMessage(l.id," Dsol, je rencontre des difficults techniques. Veuillez ressayer dans quelques instants ou contacter le support  support@montoit.ci","assistant");at&&n(I=>[...I,at])}a(!1),(st=m.current)==null||st.focus()},_=M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),j())},R=M=>{j(M.message)},z=M=>{j(M)},A=async()=>{!p||!l||(await sr.archiveConversation(l.id),u(null),n([]),h(!0),await P(),await E())},W=async M=>{u(M);const ie=await sr.getConversationMessages(M.id);n(ie),v(!1),h(!1)};return p?d.jsxs(d.Fragment,{children:[!t&&d.jsxs("button",{onClick:()=>e(!0),className:"fixed bottom-6 right-6 bg-gradient-to-r from-terracotta-500 to-coral-500 text-white rounded-full p-4 shadow-2xl hover:shadow-glow transition-all duration-300 hover:scale-110 z-50 group","aria-label":"Ouvrir le chat",children:[d.jsx(_v,{className:"h-7 w-7 group-hover:animate-bounce"}),d.jsx("span",{className:"absolute -top-1 -right-1 bg-green-500 w-4 h-4 rounded-full animate-pulse border-2 border-white"})]}),t&&d.jsxs("div",{className:"fixed bottom-6 right-6 w-[420px] h-[650px] bg-white rounded-3xl shadow-2xl flex flex-col z-50 border border-gray-200 animate-scale-in overflow-hidden",children:[d.jsxs("div",{className:"bg-gradient-to-r from-terracotta-500 via-coral-500 to-terracotta-600 text-white p-4 flex items-center justify-between relative overflow-hidden",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 to-transparent opacity-50"}),d.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[d.jsx("div",{className:"bg-white/20 backdrop-blur-sm p-2.5 rounded-full ring-2 ring-white/30",children:d.jsx(sc,{className:"h-6 w-6"})}),d.jsxs("div",{children:[d.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:["SUTA",d.jsx(kE,{className:"h-4 w-4 animate-pulse"})]}),d.jsxs("p",{className:"text-xs text-white/90 flex items-center gap-1",children:[d.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Assistant Protecteur  Toujours disponible"]})]})]}),d.jsxs("div",{className:"flex items-center gap-1 relative z-10",children:[d.jsxs("button",{onClick:()=>v(!f),className:"p-2 hover:bg-white/20 rounded-lg transition-colors relative",title:"Historique",children:[d.jsx(iE,{className:"h-5 w-5"}),y.length>1&&d.jsx("span",{className:"absolute -top-1 -right-1 bg-yellow-400 text-terracotta-800 text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center",children:y.length})]}),d.jsx("button",{onClick:A,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Nouvelle conversation",children:d.jsx(bE,{className:"h-5 w-5"})}),d.jsx("button",{onClick:()=>e(!1),className:"p-2 hover:bg-white/20 rounded-lg transition-colors","aria-label":"Fermer le chat",children:d.jsx(_d,{className:"h-5 w-5"})})]})]}),f&&d.jsxs("div",{className:"bg-gray-50 border-b border-gray-200 p-3 max-h-48 overflow-y-auto",children:[d.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Conversations rcentes"}),d.jsx("div",{className:"space-y-2",children:y.map(M=>d.jsxs("button",{onClick:()=>W(M),className:`w-full text-left p-2 rounded-lg transition-colors ${M.id===(l==null?void 0:l.id)?"bg-terracotta-100 border border-terracotta-300":"bg-white hover:bg-gray-100 border border-gray-200"}`,children:[d.jsx("div",{className:"text-sm font-medium text-gray-900",children:M.title}),d.jsx("div",{className:"text-xs text-gray-500",children:new Date(M.updated_at).toLocaleDateString("fr-FR")})]},M.id))})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gradient-to-b from-gray-50 to-white",children:[r.map((M,ie)=>d.jsx(RE,{role:M.role,content:M.content,timestamp:M.created_at,isNew:ie===r.length-1},M.id)),o&&d.jsxs("div",{className:"flex gap-3",children:[d.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center",children:d.jsx(sc,{className:"h-5 w-5 text-white"})}),d.jsx("div",{className:"bg-white rounded-2xl rounded-tl-none px-4 py-3 border-2 border-gray-200 shadow-sm",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(hE,{className:"h-4 w-4 animate-spin text-terracotta-500"}),d.jsx("span",{className:"text-sm text-gray-600",children:"SUTA analyse votre demande..."})]})})]}),c&&r.length<=1&&d.jsxs("div",{className:"animate-fade-in",children:[d.jsxs("div",{className:"text-center mb-4",children:[d.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:" Actions rapides"}),d.jsx("p",{className:"text-xs text-gray-500",children:"Choisissez une option ou posez votre question"})]}),d.jsx("div",{className:"grid grid-cols-2 gap-2",children:OE.map((M,ie)=>d.jsxs("button",{onClick:()=>R(M),className:"flex flex-col items-center gap-2 p-3 bg-white rounded-xl border-2 border-gray-200 hover:border-terracotta-400 hover:shadow-md transition-all group",children:[d.jsx("div",{className:`bg-gradient-to-br ${M.color} p-2 rounded-lg group-hover:scale-110 transition-transform`,children:d.jsx(M.icon,{className:"h-5 w-5 text-white"})}),d.jsx("span",{className:"text-xs font-medium text-gray-700 text-center leading-tight",children:M.label})]},ie))}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h4",{className:"text-xs font-semibold text-gray-600 mb-2",children:" Suggestions"}),d.jsx("div",{className:"space-y-2",children:NE.map((M,ie)=>d.jsx("button",{onClick:()=>z(M),className:"w-full text-left p-2 px-3 bg-white rounded-lg border border-gray-200 hover:border-terracotta-400 hover:bg-terracotta-50 transition-all text-xs text-gray-700",children:M},ie))})]})]}),d.jsx("div",{ref:k})]}),d.jsxs("div",{className:"p-4 border-t border-gray-200 bg-white",children:[d.jsxs("div",{className:"flex items-end gap-2",children:[d.jsx("textarea",{ref:m,value:i,onChange:M=>s(M.target.value),onKeyPress:_,placeholder:"Posez votre question  SUTA...",className:"flex-1 resize-none border-2 border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-terracotta-400 focus:border-terracotta-400 max-h-24 text-sm transition-all",rows:1,disabled:o}),d.jsx("button",{onClick:()=>j(),disabled:!i.trim()||o,className:"bg-gradient-to-r from-terracotta-500 to-coral-500 text-white p-3 rounded-xl hover:shadow-lg hover:scale-105 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100","aria-label":"Envoyer le message",children:d.jsx(xv,{className:"h-5 w-5"})})]}),d.jsxs("div",{className:"flex items-center justify-between mt-2",children:[d.jsx("p",{className:"text-xs text-gray-400",children:" Assistance scurise 24/7 par IA"}),d.jsx("p",{className:"text-xs text-gray-400",children:"Aliment par Azure AI"})]})]})]})]}):null}function IE(){const{user:t}=fd(),[e,r]=x.useState(0);return x.useEffect(()=>{if(!t)return;const i=async()=>{try{const{count:o,error:a}=await fe.from("messages").select("*",{count:"exact",head:!0}).eq("receiver_id",t.id).eq("is_read",!1);if(a)throw a;r(o||0)}catch(o){console.error("Error fetching unread count:",o)}};i();const s=fe.channel("message_notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`receiver_id=eq.${t.id}`},()=>{i(),"Notification"in window&&Notification.permission==="granted"&&new Notification("Nouveau message",{body:"Vous avez reu un nouveau message",icon:"/favicon.ico"})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages",filter:`receiver_id=eq.${t.id}`},()=>{i()}).subscribe();return()=>{s.unsubscribe()}},[t]),{unreadCount:e,requestNotificationPermission:async()=>{"Notification"in window&&Notification.permission==="default"&&await Notification.requestPermission()}}}function LE(){const[t,e]=x.useState(()=>{const r=typeof window<"u"?window.innerWidth:1024;return{width:r,isMobile:r<768,isTablet:r>=768&&r<1024,isDesktop:r>=1024,current:r<768?"mobile":r<1024?"tablet":"desktop"}});return x.useEffect(()=>{const r=()=>{const n=window.innerWidth;e({width:n,isMobile:n<768,isTablet:n>=768&&n<1024,isDesktop:n>=1024,current:n<768?"mobile":n<1024?"tablet":"desktop"})};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),t}function DE(){var l;const{theme:t,actualTheme:e,setTheme:r}=vx(),[n,i]=x.useState(!1),s=[{value:"light",label:"Clair",icon:Uf},{value:"dark",label:"Sombre",icon:vE},{value:"system",label:"Systme",icon:gE}],a=((l=s.find(u=>u.value===t))==null?void 0:l.icon)||Uf;return d.jsxs("div",{className:"relative",children:[d.jsx("button",{onClick:()=>i(!n),onBlur:()=>setTimeout(()=>i(!1),200),className:"p-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"Changer le thme",children:d.jsx(a,{className:`h-5 w-5 ${e==="dark"?"text-yellow-400":"text-gray-700"}`})}),n&&d.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 py-2 z-50 animate-scale-in",children:s.map(u=>{const c=u.icon,h=t===u.value;return d.jsxs("button",{onClick:()=>{r(u.value),i(!1)},className:`w-full flex items-center space-x-3 px-4 py-2 text-sm transition-colors ${h?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 font-semibold":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[d.jsx(c,{className:"h-4 w-4"}),d.jsx("span",{children:u.label}),h&&d.jsx("span",{className:"ml-auto text-blue-600 dark:text-blue-400",children:""})]},u.value)})})]})}function ME(){const{user:t,profile:e,signOut:r}=fd(),{unreadCount:n}=IE(),{isMobile:i}=LE(),[s,o]=x.useState(!1),[a,l]=x.useState(!1),[u,c]=x.useState(!1),h=(e==null?void 0:e.user_type)==="proprietaire"||(e==null?void 0:e.active_role)==="proprietaire";x.useEffect(()=>{const y=()=>{c(window.scrollY>20)};return window.addEventListener("scroll",y),()=>window.removeEventListener("scroll",y)},[]);const f=[{label:"Rechercher",href:"/recherche",icon:SE},...t&&h?[{label:"Publier",href:"/ajouter-propriete",icon:wE}]:[],...t?[{label:"Messages",href:"/messages",icon:_v,badge:n}]:[]],v=t?[{label:"Mon Profil",href:"/profil",icon:ds},{label:"Mes Favoris",href:"/favoris",icon:aE},{label:"Mes Visites",href:"/mes-visites",icon:vv},{label:"Mes Alertes",href:"/recherches-sauvegardees",icon:rE},{label:"Mes Contrats",href:"/mes-contrats",icon:wv},{label:"Paramtres",href:"/profil",icon:EE}]:[];return d.jsxs(d.Fragment,{children:[d.jsx("header",{className:`header-premium ${u?"scrolled":""}`,children:d.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:d.jsxs("div",{className:"flex justify-between items-center h-16 md:h-20",children:[d.jsxs("a",{href:"/",className:"header-logo header-logo-animated flex items-center space-x-2 md:space-x-3 flex-shrink-0",children:[d.jsx("div",{className:"relative",children:d.jsx("img",{src:"/logo-montoit.png",alt:"Mon Toit",className:"h-10 w-10 md:h-12 md:w-12 object-contain"})}),d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"text-lg md:text-xl font-bold gradient-text-orange",children:"Mon Toit"}),!i&&d.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Plateforme Immobilire"})]})]}),d.jsxs("nav",{className:"hidden md:flex items-center space-x-1",children:[d.jsxs("a",{href:"/",className:"header-nav-link header-nav-link-animated flex items-center space-x-2",style:{animationDelay:"0.1s"},children:[d.jsx(Ks,{className:"h-5 w-5"}),d.jsx("span",{children:"Accueil"})]}),f.map((y,w)=>d.jsxs("a",{href:y.href,className:"header-nav-link header-nav-link-animated flex items-center space-x-2 relative",style:{animationDelay:`${.2+w*.1}s`},children:[d.jsx(y.icon,{className:"h-5 w-5 header-btn-icon"}),d.jsx("span",{children:y.label}),y.badge&&y.badge>0&&d.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center animate-pulse",children:y.badge>9?"9+":y.badge})]},y.label)),d.jsx("div",{className:"ml-2",children:d.jsx(DE,{})}),t?d.jsxs("div",{className:"relative ml-2",children:[d.jsxs("button",{onClick:()=>l(!a),onBlur:()=>setTimeout(()=>l(!1),200),className:"header-btn-primary flex items-center space-x-2",children:[d.jsx(ds,{className:"h-5 w-5 header-btn-icon"}),d.jsx("span",{children:"Mon Compte"})]}),a&&d.jsxs("div",{className:"absolute right-0 mt-2 w-56 glass rounded-xl shadow-premium border border-gray-200 dark:border-gray-700 py-2 z-50 animate-fade-in",children:[d.jsxs("div",{className:"px-4 py-2 border-b border-gray-100 dark:border-gray-700",children:[d.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:(e==null?void 0:e.full_name)||"Utilisateur"}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:t.email})]}),v.map(y=>d.jsxs("a",{href:y.href,className:"flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:text-orange-600 dark:hover:text-orange-400 transition-all duration-200",children:[d.jsx(y.icon,{className:"h-4 w-4"}),d.jsx("span",{children:y.label})]},y.label)),d.jsx("div",{className:"border-t border-gray-100 dark:border-gray-700 mt-2 pt-2",children:d.jsxs("button",{onClick:r,className:"flex items-center space-x-3 px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-all duration-200 w-full",children:[d.jsx(Mf,{className:"h-4 w-4"}),d.jsx("span",{children:"Dconnexion"})]})})]})]}):d.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[d.jsxs("a",{href:"/connexion",className:"header-btn-secondary flex items-center space-x-2",children:[d.jsx(ds,{className:"h-5 w-5 header-btn-icon"}),d.jsx("span",{children:"Connexion"})]}),d.jsx("a",{href:"/inscription",className:"header-btn-primary flex items-center space-x-2",children:d.jsx("span",{children:"Inscription"})})]})]}),d.jsx("button",{onClick:()=>o(!s),className:"md:hidden p-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all",children:s?d.jsx(_d,{className:"h-6 w-6"}):d.jsx(mE,{className:"h-6 w-6"})})]})})}),d.jsx("div",{className:`header-mobile-backdrop ${s?"open":""}`,onClick:()=>o(!1)}),d.jsx("div",{className:`header-mobile-menu ${s?"open":""}`,children:d.jsxs("div",{className:"p-6 space-y-4",children:[t&&d.jsxs("div",{className:"header-mobile-item pb-4 border-b border-gray-200 dark:border-gray-700",children:[d.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:(e==null?void 0:e.full_name)||"Utilisateur"}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:t.email})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("a",{href:"/",className:"header-mobile-item flex items-center space-x-3 px-4 py-3 rounded-xl text-gray-700 dark:text-gray-300 hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:text-orange-600 dark:hover:text-orange-400 transition-all",children:[d.jsx(Ks,{className:"h-5 w-5"}),d.jsx("span",{className:"font-semibold",children:"Accueil"})]}),f.map(y=>d.jsxs("a",{href:y.href,className:"header-mobile-item flex items-center space-x-3 px-4 py-3 rounded-xl text-gray-700 dark:text-gray-300 hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:text-orange-600 dark:hover:text-orange-400 transition-all relative",children:[d.jsx(y.icon,{className:"h-5 w-5"}),d.jsx("span",{className:"font-semibold",children:y.label}),y.badge&&y.badge>0&&d.jsx("span",{className:"ml-auto bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:y.badge>9?"9+":y.badge})]},y.label)),t&&v.map(y=>d.jsxs("a",{href:y.href,className:"header-mobile-item flex items-center space-x-3 px-4 py-3 rounded-xl text-gray-700 dark:text-gray-300 hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:text-orange-600 dark:hover:text-orange-400 transition-all",children:[d.jsx(y.icon,{className:"h-5 w-5"}),d.jsx("span",{className:"font-semibold",children:y.label})]},y.label))]}),d.jsx("div",{className:"header-mobile-item pt-4 border-t border-gray-200 dark:border-gray-700 space-y-2",children:t?d.jsxs("button",{onClick:r,className:"flex items-center justify-center space-x-2 w-full px-4 py-3 rounded-xl text-red-600 dark:text-red-400 border-2 border-red-600 dark:border-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-all font-semibold",children:[d.jsx(Mf,{className:"h-5 w-5"}),d.jsx("span",{children:"Dconnexion"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("a",{href:"/connexion",className:"flex items-center justify-center space-x-2 w-full px-4 py-3 rounded-xl text-orange-600 dark:text-orange-400 border-2 border-orange-600 dark:border-orange-400 hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-all font-semibold",children:[d.jsx(ds,{className:"h-5 w-5"}),d.jsx("span",{children:"Connexion"})]}),d.jsx("a",{href:"/inscription",className:"flex items-center justify-center w-full px-4 py-3 rounded-xl gradient-orange text-white hover:shadow-orange-hover transition-all font-semibold",children:d.jsx("span",{children:"Inscription"})})]})})]})})]})}function UE(){const[t,e]=x.useState(""),[r,n]=x.useState(!1),i=a=>{a.preventDefault(),n(!0),e(""),setTimeout(()=>n(!1),3e3)},s=Array.from({length:15},(a,l)=>({id:l,left:`${Math.random()*100}%`,delay:`${Math.random()*20}s`,duration:`${20+Math.random()*10}s`})),o=Array.from({length:5},(a,l)=>({id:l,left:`${20+l*15}%`,delay:`${l*.8}s`}));return d.jsxs("footer",{className:"footer-premium",children:[d.jsx("div",{className:"footer-wave"}),d.jsx("div",{className:"footer-particles",children:s.map(a=>d.jsx("div",{className:"footer-particle",style:{left:a.left,animationDelay:a.delay,animationDuration:a.duration}},a.id))}),d.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 relative z-10",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-10 mb-12",children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center space-x-3 mb-6 group",children:[d.jsx("img",{src:"/logo-montoit.png",alt:"Mon Toit Logo",className:"h-12 w-12 object-contain group-hover:scale-110 transition-all duration-300"}),d.jsx("span",{className:"text-2xl font-bold text-white",children:"MON TOIT"})]}),d.jsx("p",{className:"text-sm text-gray-400 leading-relaxed mb-6",children:"Plateforme immobilire certifie pour un accs universel au logement en Cte d'Ivoire."}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("a",{href:"#",className:"footer-social-icon","aria-label":"Facebook",children:d.jsx(oE,{className:"h-5 w-5"})}),d.jsx("a",{href:"#",className:"footer-social-icon","aria-label":"Twitter",children:d.jsx(jE,{className:"h-5 w-5"})}),d.jsx("a",{href:"#",className:"footer-social-icon","aria-label":"Instagram",children:d.jsx(cE,{className:"h-5 w-5"})}),d.jsx("a",{href:"#",className:"footer-social-icon","aria-label":"LinkedIn",children:d.jsx(dE,{className:"h-5 w-5"})})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"footer-section-title",children:"Liens rapides"}),d.jsxs("ul",{className:"space-y-3 text-sm",children:[d.jsx("li",{children:d.jsx("a",{href:"/",className:"footer-link",children:"Accueil"})}),d.jsx("li",{children:d.jsx("a",{href:"/recherche",className:"footer-link",children:"Rechercher"})}),d.jsx("li",{children:d.jsx("a",{href:"/a-propos",className:"footer-link",children:" propos"})}),d.jsx("li",{children:d.jsx("a",{href:"/comment-ca-marche",className:"footer-link",children:"Comment a marche"})}),d.jsx("li",{children:d.jsx("a",{href:"/contact",className:"footer-link",children:"Contact"})})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"footer-section-title",children:"Lgal"}),d.jsxs("ul",{className:"space-y-3 text-sm",children:[d.jsx("li",{children:d.jsx("a",{href:"/conditions-utilisation",className:"footer-link",children:"Conditions d'utilisation"})}),d.jsx("li",{children:d.jsx("a",{href:"/politique-confidentialite",className:"footer-link",children:"Politique de confidentialit"})}),d.jsx("li",{children:d.jsx("a",{href:"/mentions-legales",className:"footer-link",children:"Mentions lgales"})}),d.jsx("li",{children:d.jsx("a",{href:"/cgv",className:"footer-link",children:"CGV"})})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"footer-section-title",children:"Newsletter"}),d.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Recevez nos dernires offres et actualits"}),d.jsxs("form",{onSubmit:i,className:"space-y-3",children:[d.jsx("input",{type:"email",value:t,onChange:a=>e(a.target.value),placeholder:"votre@email.com",required:!0,className:"footer-newsletter-input w-full"}),d.jsxs("button",{type:"submit",className:`footer-newsletter-btn w-full flex items-center justify-center space-x-2 ${r?"footer-newsletter-success":""}`,children:[d.jsx(xv,{className:"h-4 w-4"}),d.jsx("span",{children:r?"Inscrit !":"S'inscrire"})]})]}),d.jsxs("div",{className:"mt-6 space-y-2 text-sm text-gray-400",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(yE,{className:"h-4 w-4 text-orange-400"}),d.jsx("span",{children:"+225 XX XX XX XX XX"})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(fE,{className:"h-4 w-4 text-orange-400"}),d.jsx("span",{children:"contact@montoit.ci"})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(pE,{className:"h-4 w-4 text-orange-400"}),d.jsx("span",{children:"Abidjan, Cte d'Ivoire"})]})]})]})]}),d.jsx("div",{className:"footer-separator mb-8"}),d.jsxs("div",{className:"footer-copyright",children:[d.jsx("div",{className:"footer-copyright-particles",children:o.map(a=>d.jsx("div",{className:"footer-copyright-particle",style:{left:a.left,animationDelay:a.delay}},a.id))}),d.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0 relative z-10",children:[d.jsxs("p",{className:"footer-copyright-text text-sm",children:[" ",new Date().getFullYear()," Mon Toit. Tous droits rservs."]}),d.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[d.jsx("a",{href:"/aide",className:"footer-link",children:"Aide"}),d.jsx("a",{href:"/faq",className:"footer-link",children:"FAQ"}),d.jsx("a",{href:"/blog",className:"footer-link",children:"Blog"})]})]}),d.jsx("div",{className:"mt-6 flex justify-center",children:d.jsxs("div",{className:"inline-flex items-center space-x-2 px-4 py-2 bg-white/5 backdrop-blur-sm rounded-full border border-white/10",children:[d.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),d.jsx("span",{className:"text-xs text-gray-400",children:"Certifi ANSUT"})]})})]})]})]})}class oc extends x.Component{constructor(r){super(r);Vn(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});Vn(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,n){console.error("ErrorBoundary caught an error:",r,n),this.setState({error:r,errorInfo:n}),console.error("Error details:",{message:r.message,stack:r.stack,componentStack:n.componentStack})}render(){return this.state.hasError?d.jsx("div",{className:"min-h-screen bg-gradient-to-br from-terracotta-50 via-coral-50 to-amber-50 flex items-center justify-center p-4",children:d.jsx("div",{className:"max-w-2xl w-full",children:d.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl p-8 md:p-12 border-4 border-terracotta-100",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-red-100 rounded-full mb-4",children:d.jsx(gv,{className:"w-10 h-10 text-red-600"})}),d.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-3",children:"Oups ! Une erreur est survenue"}),d.jsx("p",{className:"text-lg text-gray-600",children:"Nous sommes dsols, quelque chose s'est mal pass."})]}),!1,d.jsxs("div",{className:"space-y-4",children:[d.jsxs("button",{onClick:this.handleReset,className:"w-full btn-primary py-4 text-lg font-bold flex items-center justify-center space-x-2",children:[d.jsx(xE,{className:"w-5 h-5"}),d.jsx("span",{children:"Ressayer"})]}),d.jsxs("button",{onClick:this.handleGoHome,className:"w-full px-6 py-4 bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold rounded-2xl transition-all transform hover:scale-105 flex items-center justify-center space-x-2",children:[d.jsx(Ks,{className:"w-5 h-5"}),d.jsx("span",{children:"Retour  l'accueil"})]})]}),d.jsx("div",{className:"mt-8 p-4 bg-olive-50 border-2 border-olive-200 rounded-xl",children:d.jsx("p",{className:"text-sm text-olive-800 text-center",children:"Si le problme persiste, veuillez contacter notre support technique."})})]})})}):this.props.children}}let zE=0;const Qs=new Set;let Ir=[];function ac(t,e){t.forEach(r=>r([...e]))}function Wt(t,e){const r=`toast-${++zE}`,n={id:r,type:(e==null?void 0:e.type)||"info",message:t,description:e==null?void 0:e.description,duration:(e==null?void 0:e.duration)||5e3};return Ir.push(n),ac(Qs,Ir),n.duration&&setTimeout(()=>{Ir=Ir.filter(i=>i.id!==r),ac(Qs,Ir)},n.duration),r}Wt.success=(t,e)=>Wt(t,{...e,type:"success"});Wt.error=(t,e)=>Wt(t,{...e,type:"error"});Wt.info=(t,e)=>Wt(t,{...e,type:"info"});Wt.warning=(t,e)=>Wt(t,{...e,type:"warning"});Wt.dismiss=t=>{Ir=Ir.filter(e=>e.id!==t),ac(Qs,Ir)};function $E(){const[t,e]=x.useState([]);return x.useEffect(()=>{const r=n=>{e(n)};return Qs.add(r),()=>{Qs.delete(r)}},[]),{toasts:t,toast:Wt,dismiss:Wt.dismiss}}function FE(){const{toasts:t,dismiss:e}=$E(),r={success:d.jsx(yv,{className:"h-5 w-5 text-green-600"}),error:d.jsx(PE,{className:"h-5 w-5 text-red-600"}),info:d.jsx(uE,{className:"h-5 w-5 text-blue-600"}),warning:d.jsx(gv,{className:"h-5 w-5 text-yellow-600"})},n={success:"bg-green-50 border-green-200",error:"bg-red-50 border-red-200",info:"bg-blue-50 border-blue-200",warning:"bg-yellow-50 border-yellow-200"};return t.length===0?null:d.jsx("div",{className:"fixed bottom-4 right-4 z-50 space-y-2 max-w-md",children:t.map(i=>d.jsxs("div",{className:`${n[i.type]} border-2 rounded-xl p-4 shadow-lg animate-slide-up flex items-start gap-3 min-w-[320px]`,children:[d.jsx("div",{className:"flex-shrink-0",children:r[i.type]}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"font-semibold text-gray-900 text-sm",children:i.message}),i.description&&d.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i.description})]}),d.jsx("button",{onClick:()=>e(i.id),className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:d.jsx(_d,{className:"h-5 w-5"})})]},i.id))})}const $f=["/connexion","/inscription","/messages","/auth/callback"],BE=["/messages","/admin/tableau-de-bord","/admin/utilisateurs","/admin/service-monitoring","/admin/service-configuration","/admin/test-data-generator","/admin/demo-rapide","/admin/gestion-roles","/admin/cev-management","/visiter","/mes-visites","/creer-contrat","/contrat","/signer-bail","/bail/signer","/verification","/certification-ansut","/mes-certificats","/admin/api-keys","/admin/service-providers"];function VE(){const e=Bi().pathname,r=!$f.includes(e),n=!BE.some(i=>e.startsWith(i))&&!$f.includes(e);return r?d.jsxs(oc,{children:[n&&d.jsx(ME,{}),d.jsx(FE,{}),d.jsx(x.Suspense,{fallback:d.jsx("div",{className:"min-h-screen flex items-center justify-center",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-terracotta-500"})}),children:d.jsx("main",{className:n?"min-h-screen":"",children:d.jsx(Af,{})})}),n&&d.jsx(UE,{}),d.jsx(zf,{})]}):d.jsx(oc,{children:d.jsxs(x.Suspense,{fallback:d.jsx("div",{className:"min-h-screen flex items-center justify-center",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-terracotta-500"})}),children:[d.jsx(Af,{}),d.jsx(zf,{})]})})}const qE={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im11aWlkdnptcGNtY21yeHV3dHF0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQwNDQzMDgsImV4cCI6MjA3OTYyMDMwOH0.WURqe9zpb_hSZyJrHOXswxEkByungk_U1fYGeqfLJag",VITE_SUPABASE_URL:"https://muiidvzmpcmcmrxuwtqt.supabase.co"},Ff=t=>{let e;const r=new Set,n=(c,h)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const v=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),r.forEach(y=>y(e,v))}},i=()=>e,l={setState:n,getState:i,getInitialState:()=>u,subscribe:c=>(r.add(c),()=>r.delete(c)),destroy:()=>{(qE?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=e=t(n,i,l);return l},HE=t=>t?Ff(t):Ff;var Sv={exports:{}},Ev={},kv={exports:{}},bv={};/**
 */var rl=x,rk=tk;function nk(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ik=typeof Object.is=="function"?Object.is:nk,sk=rk.useSyncExternalStore,ok=rl.useRef,ak=rl.useEffect,lk=rl.useMemo,uk=rl.useDebugValue;Ev.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var s=ok(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=lk(function(){function l(v){if(!u){if(u=!0,c=v,v=n(v),i!==void 0&&o.hasValue){var y=o.value;if(i(y,v))return h=y}return h=v}if(y=h,ik(c,v))return y;var w=n(v);return i!==void 0&&i(y,w)?(c=v,y):(c=v,h=w)}var u=!1,c,h,f=r===void 0?null:r;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,r,n,i]);var a=sk(t,s[0],s[1]);return ak(function(){o.hasValue=!0,o.value=a},[a]),uk(a),a};Sv.exports=Ev;var ck=Sv.exports;const dk=cc(ck),jv={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im11aWlkdnptcGNtY21yeHV3dHF0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQwNDQzMDgsImV4cCI6MjA3OTYyMDMwOH0.WURqe9zpb_hSZyJrHOXswxEkByungk_U1fYGeqfLJag",VITE_SUPABASE_URL:"https://muiidvzmpcmcmrxuwtqt.supabase.co"},{useDebugValue:hk}=gp,{useSyncExternalStoreWithSelector:fk}=dk;let Bf=!1;const pk=t=>t;function mk(t,e=pk,r){(jv?"production":void 0)!=="production"&&r&&!Bf&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Bf=!0);const n=fk(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,r);return hk(n),n}const gk=t=>{(jv?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?HE(t):t,r=(n,i)=>mk(e,n,i);return Object.assign(r,e),r},vk=t=>gk,ea={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im11aWlkdnptcGNtY21yeHV3dHF0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQwNDQzMDgsImV4cCI6MjA3OTYyMDMwOH0.WURqe9zpb_hSZyJrHOXswxEkByungk_U1fYGeqfLJag",VITE_SUPABASE_URL:"https://muiidvzmpcmcmrxuwtqt.supabase.co"},lc=new Map,$o=t=>{const e=lc.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([r,n])=>[r,n.getState()])):{}},yk=(t,e,r)=>{if(t===void 0)return{type:"untracked",connection:e.connect(r)};const n=lc.get(r.name);if(n)return{type:"tracked",store:t,...n};const i={connection:e.connect(r),stores:{}};return lc.set(r.name,i),{type:"tracked",store:t,...i}},wk=(t,e={})=>(r,n,i)=>{const{enabled:s,anonymousActionType:o,store:a,...l}=e;let u;try{u=(s??(ea?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return(ea?"production":void 0)!=="production"&&s&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),t(r,n,i);const{connection:c,...h}=yk(a,u,l);let f=!0;i.setState=(w,k,m)=>{const p=r(w,k);if(!f)return p;const g=m===void 0?{type:o||"anonymous"}:typeof m=="string"?{type:m}:m;return a===void 0?(c==null||c.send(g,n()),p):(c==null||c.send({...g,type:`${a}/${g.type}`},{...$o(l.name),[a]:i.getState()}),p)};const v=(...w)=>{const k=f;f=!1,r(...w),f=k},y=t(i.setState,n,i);if(h.type==="untracked"?c==null||c.init(y):(h.stores[h.store]=i,c==null||c.init(Object.fromEntries(Object.entries(h.stores).map(([w,k])=>[w,w===h.store?y:k.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let w=!1;const k=i.dispatch;i.dispatch=(...m)=>{(ea?"production":void 0)!=="production"&&m[0].type==="__setState"&&!w&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),w=!0),k(...m)}}return c.subscribe(w=>{var k;switch(w.type){case"ACTION":if(typeof w.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Wl(w.payload,m=>{if(m.type==="__setState"){if(a===void 0){v(m.state);return}Object.keys(m.state).length!==1&&console.error(`
                    `);const p=m.state[a];if(p==null)return;JSON.stringify(i.getState())!==JSON.stringify(p)&&v(p);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(m)});case"DISPATCH":switch(w.payload.type){case"RESET":return v(y),a===void 0?c==null?void 0:c.init(i.getState()):c==null?void 0:c.init($o(l.name));case"COMMIT":if(a===void 0){c==null||c.init(i.getState());return}return c==null?void 0:c.init($o(l.name));case"ROLLBACK":return Wl(w.state,m=>{if(a===void 0){v(m),c==null||c.init(i.getState());return}v(m[a]),c==null||c.init($o(l.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Wl(w.state,m=>{if(a===void 0){v(m);return}JSON.stringify(i.getState())!==JSON.stringify(m[a])&&v(m[a])});case"IMPORT_STATE":{const{nextLiftedState:m}=w.payload,p=(k=m.computedStates.slice(-1)[0])==null?void 0:k.state;if(!p)return;v(a===void 0?p:p[a]),c==null||c.send(null,m);return}case"PAUSE_RECORDING":return f=!f}return}}),y},_k=wk,Wl=(t,e)=>{let r;try{r=JSON.parse(t)}catch(n){console.error("[zustand devtools middleware] Could not parse the received json",n)}r!==void 0&&e(r)};function xk(t,e){let r;try{r=t()}catch{return}return{getItem:i=>{var s;const o=l=>l===null?null:JSON.parse(l,void 0),a=(s=r.getItem(i))!=null?s:null;return a instanceof Promise?a.then(o):o(a)},setItem:(i,s)=>r.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>r.removeItem(i)}}const Js=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return Js(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Js(n)(r)}}}},Sk=(t,e)=>(r,n,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:k=>k,version:0,merge:(k,m)=>({...m,...k}),...e},o=!1;const a=new Set,l=new Set;let u;try{u=s.getStorage()}catch{}if(!u)return t((...k)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),r(...k)},n,i);const c=Js(s.serialize),h=()=>{const k=s.partialize({...n()});let m;const p=c({state:k,version:s.version}).then(g=>u.setItem(s.name,g)).catch(g=>{m=g});if(m)throw m;return p},f=i.setState;i.setState=(k,m)=>{f(k,m),h()};const v=t((...k)=>{r(...k),h()},n,i);let y;const w=()=>{var k;if(!u)return;o=!1,a.forEach(p=>p(n()));const m=((k=s.onRehydrateStorage)==null?void 0:k.call(s,n()))||void 0;return Js(u.getItem.bind(u))(s.name).then(p=>{if(p)return s.deserialize(p)}).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==s.version){if(s.migrate)return s.migrate(p.state,p.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return p.state}).then(p=>{var g;return y=s.merge(p,(g=n())!=null?g:v),r(y,!0),h()}).then(()=>{m==null||m(y,void 0),o=!0,l.forEach(p=>p(y))}).catch(p=>{m==null||m(void 0,p)})};return i.persist={setOptions:k=>{s={...s,...k},k.getStorage&&(u=k.getStorage())},clearStorage:()=>{u==null||u.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:k=>(a.add(k),()=>{a.delete(k)}),onFinishHydration:k=>(l.add(k),()=>{l.delete(k)})},w(),y||v},Ek=(t,e)=>(r,n,i)=>{let s={storage:xk(()=>localStorage),partialize:w=>w,version:0,merge:(w,k)=>({...k,...w}),...e},o=!1;const a=new Set,l=new Set;let u=s.storage;if(!u)return t((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),r(...w)},n,i);const c=()=>{const w=s.partialize({...n()});return u.setItem(s.name,{state:w,version:s.version})},h=i.setState;i.setState=(w,k)=>{h(w,k),c()};const f=t((...w)=>{r(...w),c()},n,i);i.getInitialState=()=>f;let v;const y=()=>{var w,k;if(!u)return;o=!1,a.forEach(p=>{var g;return p((g=n())!=null?g:f)});const m=((k=s.onRehydrateStorage)==null?void 0:k.call(s,(w=n())!=null?w:f))||void 0;return Js(u.getItem.bind(u))(s.name).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==s.version){if(s.migrate)return[!0,s.migrate(p.state,p.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,p.state];return[!1,void 0]}).then(p=>{var g;const[E,P]=p;if(v=s.merge(P,(g=n())!=null?g:f),r(v,!0),E)return c()}).then(()=>{m==null||m(v,void 0),v=n(),o=!0,l.forEach(p=>p(v))}).catch(p=>{m==null||m(void 0,p)})};return i.persist={setOptions:w=>{s={...s,...w},w.storage&&(u=w.storage)},clearStorage:()=>{u==null||u.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:w=>(a.add(w),()=>{a.delete(w)}),onFinishHydration:w=>(l.add(w),()=>{l.delete(w)})},s.skipHydration||y(),v||f},kk=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((ea?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Sk(t,e)):Ek(t,e),bk=kk,jk=vk()(_k(bk((t,e)=>({user:null,profile:null,session:null,loading:!0,initialized:!1,error:null,profileError:null,retryCount:0,initialize:async()=>{try{const{data:{session:r}}=await fe.auth.getSession();r!=null&&r.user&&(t({session:r,user:r.user}),await e().loadProfile(r.user.id)),t({initialized:!0,loading:!1}),fe.auth.onAuthStateChange((n,i)=>{(async()=>(t({session:i,user:(i==null?void 0:i.user)??null}),i!=null&&i.user?await e().loadProfile(i.user.id):t({profile:null,loading:!1})))()})}catch(r){console.error("Error initializing auth:",r),t({initialized:!0,loading:!1})}},loadProfile:async(r,n=0)=>{try{if(console.log(`[AuthStore] Loading profile (attempt ${n+1}/6)`),t({retryCount:n}),n===0){const l=await Yg();if(!l.success){console.error("[AuthStore] Database connection failed:",l.message),t({profileError:{type:"network",message:"Connexion  la base de donnes impossible",details:l.message,timestamp:new Date},loading:!1});return}}const{data:o,error:a}=await fe.from("profiles").select("*").eq("id",r).maybeSingle();if(a){console.error("[AuthStore] Supabase error:",a);let l="database",u="Erreur lors du chargement du profil",c=a.message;if(a.code==="PGRST116"?(l="not_found",u="Profil introuvable",c="Le profil n'a pas t trouv dans la base de donnes."):a.message.includes("permission")||a.code==="42501"?(l="permission",u="Accs refus",c="Permissions insuffisantes pour accder au profil."):(a.message.includes("network")||a.message.includes("fetch"))&&(l="network",u="Erreur de connexion",c="Impossible de se connecter au serveur."),n<5){const h=1500*Math.pow(1.5,n);return console.log(`[AuthStore] Retrying in ${h}ms...`),await new Promise(f=>setTimeout(f,h)),e().loadProfile(r,n+1)}t({profileError:{type:l,message:u,details:c,timestamp:new Date},loading:!1});return}if(!o){if(console.warn("[AuthStore] No profile data returned"),n<5){const l=1500*Math.pow(1.5,n);return console.log(`[AuthStore] Profile not found, retrying in ${l}ms...`),await new Promise(u=>setTimeout(u,l)),e().loadProfile(r,n+1)}t({profileError:{type:"not_found",message:"Profil introuvable",details:"Impossible de trouver votre profil aprs plusieurs tentatives.",timestamp:new Date},loading:!1});return}console.log("[AuthStore] Profile loaded successfully"),t({profile:o,loading:!1,profileError:null,retryCount:0})}catch(o){if(console.error("[AuthStore] Unexpected error loading profile:",o),n<5){const a=1500*Math.pow(1.5,n);return console.log(`[AuthStore] Retrying after error in ${a}ms...`),await new Promise(l=>setTimeout(l,a)),e().loadProfile(r,n+1)}t({profileError:{type:"unknown",message:"Erreur inattendue",details:o.message||"Une erreur inconnue s'est produite.",timestamp:new Date},loading:!1})}},signIn:async(r,n)=>{t({loading:!0,error:null});const{error:i}=await fe.auth.signInWithPassword({email:r,password:n});return i&&t({error:i,loading:!1}),{error:i}},signUp:async(r,n,i)=>{t({loading:!0,error:null});const{error:s}=await fe.auth.signUp({email:r,password:n,options:{data:{full_name:i.full_name,user_type:i.user_type}}});return s&&t({error:s,loading:!1}),{error:s}},signOut:async()=>{t({loading:!0}),await fe.auth.signOut(),t({user:null,profile:null,session:null,loading:!1,error:null})},updateProfile:async r=>{const{user:n}=e();if(n){t({loading:!0,error:null});try{const{error:i}=await fe.from("profiles").update(r).eq("id",n.id);if(i)throw i;await e().loadProfile(n.id)}catch(i){console.error("Error updating profile:",i),t({loading:!1})}}},clearError:()=>t({error:null}),clearProfileError:()=>t({profileError:null}),forceRefresh:async()=>{const{user:r}=e();r&&(t({loading:!0,profileError:null,retryCount:0}),await e().loadProfile(r.id))}}),{name:"auth-storage",partialize:t=>({session:t.session})}),{name:"AuthStore"}));function B({children:t}){const e=tl(),{user:r,loading:n}=jk();return x.useEffect(()=>{!n&&!r&&e("/connexion",{replace:!0})},[r,n,e]),n?d.jsx("div",{className:"flex items-center justify-center min-h-screen",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):r?d.jsx(d.Fragment,{children:t}):null}class Pk extends x.Component{constructor(r){super(r);Vn(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.href="/recherche"});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){console.error("SearchErrorBoundary caught an error:",r,n),this.setState({error:r,errorInfo:n}),typeof window<"u"&&window.Sentry&&window.Sentry.captureException(r,{contexts:{react:{componentStack:n.componentStack}}})}render(){return this.state.hasError?d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:d.jsx("div",{className:"max-w-2xl w-full bg-white rounded-2xl shadow-xl p-8 md:p-12",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-red-100 rounded-full mb-6",children:d.jsx(mv,{className:"h-10 w-10 text-red-600"})}),d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Une erreur est survenue"}),d.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"La page de recherche a rencontr un problme technique. Nos quipes ont t notifies et travaillent sur une solution."}),!1,d.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[d.jsxs("button",{onClick:this.handleReset,className:"inline-flex items-center justify-center gap-2 px-6 py-3 bg-orange-500 text-white font-semibold rounded-xl hover:bg-orange-600 transition-colors",children:[d.jsx(_E,{className:"h-5 w-5"}),"Ressayer"]}),d.jsxs("a",{href:"/",className:"inline-flex items-center justify-center gap-2 px-6 py-3 bg-gray-100 text-gray-700 font-semibold rounded-xl hover:bg-gray-200 transition-colors",children:[d.jsx(Ks,{className:"h-5 w-5"}),"Retour  l'accueil"]})]}),d.jsxs("p",{className:"mt-8 text-sm text-gray-500",children:["Si le problme persiste, veuillez"," ",d.jsx("a",{href:"/contact",className:"text-orange-600 hover:text-orange-700 font-medium",children:"contacter le support"})]})]})})}):this.props.children}}const Tk=x.lazy(()=>L(()=>import("./HomePage-C0QQdpvj.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Ck=x.lazy(()=>L(()=>import("./NotFoundPage-C5DiKzdQ.js"),__vite__mapDeps([7,8]))),Vf=x.lazy(()=>L(()=>import("./AddPropertyLandingPage-DAN1PDhz.js"),__vite__mapDeps([9,5,10,11]))),qf=x.lazy(()=>L(()=>import("./AuthPage-Cvo0rBnX.js"),__vite__mapDeps([12,13,14,15,8]))),Rk=x.lazy(()=>L(()=>import("./ModernAuthPage-CJR8GOSC.js"),__vite__mapDeps([16,17,14,18,19,20,5,8]))),Ak=x.lazy(()=>L(()=>import("./CallbackPage-BFJZHg5l.js"),[])),Ok=x.lazy(()=>L(()=>import("./ForgotPasswordPage-BgR10loZ.js"),__vite__mapDeps([21,8,15]))),Nk=x.lazy(()=>L(()=>import("./ResetPasswordPage-Da7YcgVM.js"),__vite__mapDeps([22,8,14,18,19]))),Ik=x.lazy(()=>L(()=>import("./VerifyOTPPage-C8twSI0N.js"),__vite__mapDeps([23,8]))),Lk=x.lazy(()=>L(()=>import("./ProfileSelectionPage-CILnYf6d.js"),__vite__mapDeps([24,17,5,25]))),Dk=x.lazy(()=>L(()=>import("./ProfilePage-CdpXbGRr.js"),__vite__mapDeps([26,27,14,4,11,28,29,30,25,17,10,31]))),Mk=x.lazy(()=>L(()=>import("./SearchPropertiesPage-vwnySx0Y.js"),__vite__mapDeps([32,33,2]))),Kl=x.lazy(()=>L(()=>import("./PropertyDetailPage-Db2UWPEP.js"),__vite__mapDeps([34,33,2,8,1,35]))),Uk=x.lazy(()=>L(()=>import("./FavoritesPage-CL8uzXV5.js"),__vite__mapDeps([36,37,13,30,25,17,38,39,28,3,40,41,35,31]))),zk=x.lazy(()=>L(()=>import("./SavedSearchesPage-DD5-rrr-.js"),__vite__mapDeps([42,19]))),$k=x.lazy(()=>L(()=>import("./RecommendationsPage-D8fMkvcV.js"),__vite__mapDeps([43,11,2,19]))),Fk=x.lazy(()=>L(()=>import("./ApplicationFormPage-CmXcgWSi.js"),__vite__mapDeps([44,45,8,28]))),Bk=x.lazy(()=>L(()=>import("./ApplicationDetailPage-e-5aBDDc.js"),__vite__mapDeps([46,45,8,28]))),Vk=x.lazy(()=>L(()=>import("./ScheduleVisitPage-D_tq9FU3.js"),__vite__mapDeps([47,37,13,30,25,17,38,39,28,3,40,41,8,48]))),qk=x.lazy(()=>L(()=>import("./MyVisitsPage-B5fdMtsI.js"),__vite__mapDeps([49,37,13,30,25,17,38,39,28,3,40,41,48,4]))),Hk=x.lazy(()=>L(()=>import("./MessagesPage-6SDxsApY.js"),__vite__mapDeps([50,37,13,30,25,17,38,39,28,3,40,41,51]))),Wk=x.lazy(()=>L(()=>import("./CreateContractPage-B4aTdmkZ.js"),__vite__mapDeps([52,37,13,30,25,17,38,39,28,3,40,41,8,53]))),Kk=x.lazy(()=>L(()=>import("./MyContractsPage-CsxvUAxw.js"),__vite__mapDeps([54,37,13,30,25,17,38,39,28,3,40,41,19,55]))),Qk=x.lazy(()=>L(()=>import("./ContractDetailPage-Brao6C73.js"),__vite__mapDeps([56,37,13,30,25,17,38,39,28,3,40,41,8,55]))),Jk=x.lazy(()=>L(()=>import("./ContractDetailEnhancedPage-CD2T_v8Z.js"),__vite__mapDeps([57,37,13,30,25,17,38,39,28,3,40,41,58,19,59,60,8]))),Hf=x.lazy(()=>L(()=>import("./SignLeasePage-BO6uiiin.js"),__vite__mapDeps([61,37,13,30,25,17,38,39,28,3,40,41,27,14,59]))),Gk=x.lazy(()=>L(()=>import("./ContractsListPage-Av3xkRlj.js"),__vite__mapDeps([62,58,19,59]))),Yk=x.lazy(()=>L(()=>import("./MakePaymentPage-DRDaOacs.js"),__vite__mapDeps([63,37,13,30,25,17,38,39,28,3,40,41,64,53,8,65]))),Xk=x.lazy(()=>L(()=>import("./PaymentHistoryPage-AhIIfxjF.js"),__vite__mapDeps([66,37,13,30,25,17,38,39,28,3,40,41,53,19,59]))),Zk=x.lazy(()=>L(()=>import("./RequestPage-Buyntz1t.js"),__vite__mapDeps([67,37,13,30,25,17,38,39,28,3,40,41,64,60]))),Wf=x.lazy(()=>L(()=>import("./IdentityVerificationPage-D85SaFy5.js"),__vite__mapDeps([68,37,13,30,25,17,38,39,28,3,40,41,69,27,10,20,29,60]))),eb=x.lazy(()=>L(()=>import("./SettingsPage-BOLlH74c.js"),__vite__mapDeps([70,31]))),tb=x.lazy(()=>L(()=>import("./MyCertificatesPage-DLzLofAt.js"),__vite__mapDeps([71,37,13,30,25,17,38,39,28,3,40,41])));x.lazy(()=>L(()=>import("./RequestValidationPage-Bsprz3in.js"),__vite__mapDeps([72,73,69,27])));const rb=x.lazy(()=>L(()=>import("./RequestCEVPage-DSz8p10P.js"),__vite__mapDeps([74,75,60]))),nb=x.lazy(()=>L(()=>import("./CEVRequestDetailPage-CX3T47FA.js"),__vite__mapDeps([76,75,59,60]))),ib=x.lazy(()=>L(()=>import("./DashboardPage-BDuMa7vP.js"),__vite__mapDeps([77,53,78,39]))),sb=x.lazy(()=>L(()=>import("./CalendarPage-D0kIbCJU.js"),__vite__mapDeps([79,8,59,1,2,39,19,53]))),ob=x.lazy(()=>L(()=>import("./ScorePage-DD-iDpxp.js"),__vite__mapDeps([80,11,28,78,4,14,5]))),ab=x.lazy(()=>L(()=>import("./MaintenancePage-C_sw2mzp.js"),__vite__mapDeps([81,39]))),lb=x.lazy(()=>L(()=>import("./DashboardPage-BDuMa7vP.js"),__vite__mapDeps([77,53,78,39]))),Kf=x.lazy(()=>L(()=>import("./AddPropertyPage-BwCtxXyb.js"),__vite__mapDeps([82,8,83,60,17,31]))),ub=x.lazy(()=>L(()=>import("./PropertyStatsPage-TjFSIOtD.js"),__vite__mapDeps([84,8,19,11,3,4]))),cb=x.lazy(()=>L(()=>import("./MaintenancePage-C_sw2mzp.js"),__vite__mapDeps([81,39]))),db=x.lazy(()=>L(()=>import("./DashboardPage-BDuMa7vP.js"),__vite__mapDeps([77,53,78,39]))),hb=x.lazy(()=>L(()=>import("./RegistrationPage-mynmbEQv.js"),__vite__mapDeps([85,5,17,60]))),fb=x.lazy(()=>L(()=>import("./TeamPage-BVR7_Ui9.js"),__vite__mapDeps([86,3,41]))),pb=x.lazy(()=>L(()=>import("./PropertiesPage-DUIy8nwH.js"),__vite__mapDeps([87,19,53]))),mb=x.lazy(()=>L(()=>import("./CommissionsPage-HOtaEjhl.js"),__vite__mapDeps([88,89,58,53,11]))),gb=x.lazy(()=>L(()=>import("./MaintenanceRequestPage-BsmWUMe_.js"),__vite__mapDeps([90,39,10,60]))),vb=x.lazy(()=>L(()=>import("./DashboardPage-BDuMa7vP.js"),__vite__mapDeps([77,53,78,39]))),yb=x.lazy(()=>L(()=>import("./UsersPage-B1gk3NBz.js"),__vite__mapDeps([91,37,13,30,25,17,38,39,28,3,40,41,55]))),wb=x.lazy(()=>L(()=>import("./UserRolesPage-BVF5YoZw.js"),__vite__mapDeps([92,40,31,17,3]))),_b=x.lazy(()=>L(()=>import("./ApiKeysPage-BOZFu-pb.js"),__vite__mapDeps([93,37,13,30,25,17,38,39,28,3,40,41,18,19,31]))),xb=x.lazy(()=>L(()=>import("./ServiceProvidersPage-BouvpPAD.js"),__vite__mapDeps([94,37,13,30,25,17,38,39,28,3,40,41,95,53,11]))),Sb=x.lazy(()=>L(()=>import("./ServiceMonitoringPage-_qpMMhRq.js"),__vite__mapDeps([96,37,13,30,25,17,38,39,28,3,40,41,59,95,11]))),Eb=x.lazy(()=>L(()=>import("./ServiceConfigurationPage-CjgXN6fj.js"),__vite__mapDeps([97,37,13,30,25,17,38,39,28,3,40,41,53]))),kb=x.lazy(()=>L(()=>import("./TestDataGeneratorPage-CwU_rdMi.js"),__vite__mapDeps([98,95,3,59]))),bb=x.lazy(()=>L(()=>import("./QuickDemoPage-CM6cXjVe.js"),__vite__mapDeps([99,83,20,13,3]))),Qf=x.lazy(()=>L(()=>import("./CEVManagementPage-CvNz2U7G.js"),__vite__mapDeps([100,75,3,11,53,59,19]))),jb=x.lazy(()=>L(()=>import("./TrustAgentsPage-yjESEvKk.js"),__vite__mapDeps([101,41,28,55]))),Pb=x.lazy(()=>L(()=>import("./DashboardPage-BDuMa7vP.js"),__vite__mapDeps([77,53,78,39]))),Tb=x.lazy(()=>L(()=>import("./ModerationPage-Dj_ezGRw.js"),__vite__mapDeps([102,73,19]))),Cb=x.lazy(()=>L(()=>import("./MediationPage-DRXg7b8k.js"),__vite__mapDeps([103,73,78,104]))),Rb=x.lazy(()=>L(()=>import("./AnalyticsPage-BvYCBXln.js"),__vite__mapDeps([105,89,95,59,3,11]))),Ab=x.lazy(()=>L(()=>import("./NotificationPreferencesPage-CJGoWdr4.js"),__vite__mapDeps([106,78,65,31]))),Ob=x.lazy(()=>L(()=>import("./MyDisputesPage-DWZ2tmD4.js"),__vite__mapDeps([107,73,104,78]))),Nb=x.lazy(()=>L(()=>import("./CreateDisputePage-CTscvBZT.js"),__vite__mapDeps([108,73,60]))),Ib=x.lazy(()=>L(()=>import("./DisputeDetailPage-DfhtXG0l.js"),__vite__mapDeps([109,73,8,51,78]))),Lb=x.lazy(()=>L(()=>import("./AboutPage-Bhoc1qeo.js"),__vite__mapDeps([110,8,3,28]))),Jf=x.lazy(()=>L(()=>import("./TermsOfServicePage-S8K4AoyH.js"),__vite__mapDeps([111,8]))),Db=x.lazy(()=>L(()=>import("./PrivacyPolicyPage-bQLoeuzW.js"),__vite__mapDeps([112,8,19,14,40]))),Mb=x.lazy(()=>L(()=>import("./ContactPage-B5DTCNdD.js"),__vite__mapDeps([113,114,8,6]))),Ub=x.lazy(()=>L(()=>import("./HelpPage-SzHfQhcq.js"),__vite__mapDeps([115,114,8,38,6]))),zb=x.lazy(()=>L(()=>import("./FAQPage-BOfjUm2u.js"),__vite__mapDeps([116,114,8,38,6]))),$b=[{path:"/",element:d.jsx(VE,{}),errorElement:d.jsx(oc,{}),children:[{index:!0,element:d.jsx(Tk,{})},{path:"connexion",element:d.jsx(qf,{})},{path:"inscription",element:d.jsx(qf,{})},{path:"auth",element:d.jsx(Rk,{})},{path:"auth/callback",element:d.jsx(Ak,{})},{path:"mot-de-passe-oublie",element:d.jsx(Ok,{})},{path:"reinitialiser-mot-de-passe",element:d.jsx(Nk,{})},{path:"verification-otp",element:d.jsx(Ik,{})},{path:"a-propos",element:d.jsx(Lb,{})},{path:"conditions-utilisation",element:d.jsx(Jf,{})},{path:"politique-confidentialite",element:d.jsx(Db,{})},{path:"mentions-legales",element:d.jsx(Jf,{})},{path:"contact",element:d.jsx(Mb,{})},{path:"aide",element:d.jsx(Ub,{})},{path:"faq",element:d.jsx(zb,{})},{path:"ajouter-propriete",element:d.jsx(Vf,{})},{path:"louer-mon-bien",element:d.jsx(Vf,{})},{path:"choix-profil",element:d.jsx(B,{children:d.jsx(Lk,{})})},{path:"profil",element:d.jsx(B,{children:d.jsx(Dk,{})})},{path:"recherche",element:d.jsx(Pk,{children:d.jsx(Mk,{})})},{path:"propriete/:id",element:d.jsx(Kl,{})},{path:"properties/:id",element:d.jsx(Kl,{})},{path:"proprietes/:id",element:d.jsx(Kl,{})},{path:"favoris",element:d.jsx(B,{children:d.jsx(Uk,{})})},{path:"recherches-sauvegardees",element:d.jsx(B,{children:d.jsx(zk,{})})},{path:"recommandations",element:d.jsx(B,{children:d.jsx($k,{})})},{path:"candidature/:id",element:d.jsx(B,{children:d.jsx(Fk,{})})},{path:"visiter/:id",element:d.jsx(B,{children:d.jsx(Vk,{})})},{path:"mes-visites",element:d.jsx(B,{children:d.jsx(qk,{})})},{path:"messages",element:d.jsx(B,{children:d.jsx(Hk,{})})},{path:"creer-contrat/:propertyId",element:d.jsx(B,{allowedRoles:["proprietaire","agence"],children:d.jsx(Wk,{})})},{path:"mes-contrats",element:d.jsx(B,{children:d.jsx(Kk,{})})},{path:"tous-les-contrats",element:d.jsx(B,{children:d.jsx(Gk,{})})},{path:"contrat/:id",element:d.jsx(B,{children:d.jsx(Qk,{})})},{path:"bail/:id/details",element:d.jsx(B,{children:d.jsx(Jk,{})})},{path:"signer-bail/:id",element:d.jsx(B,{children:d.jsx(Hf,{})})},{path:"bail/signer/:id",element:d.jsx(B,{children:d.jsx(Hf,{})})},{path:"effectuer-paiement",element:d.jsx(B,{children:d.jsx(Yk,{})})},{path:"mes-paiements",element:d.jsx(B,{children:d.jsx(Xk,{})})},{path:"verification",element:d.jsx(B,{children:d.jsx(Zk,{})})},{path:"certification-ansut",element:d.jsx(B,{children:d.jsx(Wf,{})})},{path:"ansut-verification",element:d.jsx(B,{children:d.jsx(Wf,{})})},{path:"verification/parametres",element:d.jsx(B,{children:d.jsx(eb,{})})},{path:"mes-certificats",element:d.jsx(B,{children:d.jsx(tb,{})})},{path:"request-cev",element:d.jsx(B,{children:d.jsx(rb,{})})},{path:"cev-request/:id",element:d.jsx(B,{children:d.jsx(nb,{})})},{path:"dashboard/locataire",element:d.jsx(B,{allowedRoles:["locataire"],children:d.jsx(ib,{})})},{path:"dashboard/locataire/calendrier",element:d.jsx(B,{allowedRoles:["locataire"],children:d.jsx(sb,{})})},{path:"score-locataire",element:d.jsx(B,{allowedRoles:["locataire"],children:d.jsx(ob,{})})},{path:"maintenance/locataire",element:d.jsx(B,{allowedRoles:["locataire"],children:d.jsx(ab,{})})},{path:"dashboard/proprietaire",element:d.jsx(B,{allowedRoles:["proprietaire"],children:d.jsx(lb,{})})},{path:"dashboard/ajouter-propriete",element:d.jsx(B,{allowedRoles:["proprietaire","agence"],children:d.jsx(Kf,{})})},{path:"add-property",element:d.jsx(B,{allowedRoles:["proprietaire","agence"],children:d.jsx(Kf,{})})},{path:"dashboard/propriete/:id/stats",element:d.jsx(B,{allowedRoles:["proprietaire","agence"],children:d.jsx(ub,{})})},{path:"maintenance/proprietaire",element:d.jsx(B,{allowedRoles:["proprietaire"],children:d.jsx(cb,{})})},{path:"dashboard/candidature/:id",element:d.jsx(B,{allowedRoles:["proprietaire","agence"],children:d.jsx(Bk,{})})},{path:"agence/tableau-de-bord",element:d.jsx(B,{allowedRoles:["agence"],children:d.jsx(db,{})})},{path:"agence/inscription",element:d.jsx(B,{children:d.jsx(hb,{})})},{path:"agence/equipe",element:d.jsx(B,{allowedRoles:["agence"],children:d.jsx(fb,{})})},{path:"agence/proprietes",element:d.jsx(B,{allowedRoles:["agence"],children:d.jsx(pb,{})})},{path:"agence/commissions",element:d.jsx(B,{allowedRoles:["agence"],children:d.jsx(mb,{})})},{path:"maintenance/nouvelle",element:d.jsx(B,{children:d.jsx(gb,{})})},{path:"admin/tableau-de-bord",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(vb,{})})},{path:"admin/utilisateurs",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(yb,{})})},{path:"admin/gestion-roles",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(wb,{})})},{path:"admin/api-keys",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(_b,{})})},{path:"admin/service-providers",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(xb,{})})},{path:"admin/service-monitoring",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(Sb,{})})},{path:"admin/service-configuration",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(Eb,{})})},{path:"admin/test-data-generator",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(kb,{})})},{path:"admin/demo-rapide",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(bb,{})})},{path:"admin/cev-management",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(Qf,{})})},{path:"admin/cev/:id",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(Qf,{})})},{path:"admin/trust-agents",element:d.jsx(B,{allowedRoles:["admin"],children:d.jsx(jb,{})})},{path:"trust-agent/dashboard",element:d.jsx(B,{allowedRoles:["trust_agent"],children:d.jsx(Pb,{})})},{path:"trust-agent/moderation",element:d.jsx(B,{allowedRoles:["trust_agent"],children:d.jsx(Tb,{})})},{path:"trust-agent/mediation",element:d.jsx(B,{allowedRoles:["trust_agent"],children:d.jsx(Cb,{})})},{path:"trust-agent/analytics",element:d.jsx(B,{allowedRoles:["trust_agent"],children:d.jsx(Rb,{})})},{path:"notifications/preferences",element:d.jsx(B,{children:d.jsx(Ab,{})})},{path:"mes-litiges",element:d.jsx(B,{children:d.jsx(Ob,{})})},{path:"creer-litige",element:d.jsx(B,{children:d.jsx(Nb,{})})},{path:"litige/:id",element:d.jsx(B,{children:d.jsx(Ib,{})})},{path:"*",element:d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:d.jsxs("div",{className:"text-center",children:[d.jsx("h1",{className:"text-6xl font-bold text-gray-900 mb-4",children:"404"}),d.jsx("h2",{className:"text-2xl font-semibold text-gray-700 mb-4",children:"Page non trouve"}),d.jsx("p",{className:"text-gray-600 mb-8",children:"La page que vous recherchez n'existe pas."}),d.jsx("a",{href:"/",className:"inline-block px-6 py-3 bg-terracotta-500 text-white rounded-lg hover:bg-terracotta-600 transition-colors",children:"Retour  l'accueil"})]})})}]},{path:"*",element:d.jsx(Ck,{})}],Fb=zS($b);function Bb(){return d.jsx(QS,{router:Fb})}const Vb=Gw();yx();wg(document.getElementById("root")).render(d.jsx(x.StrictMode,{children:d.jsx(gx,{children:d.jsx(Qw,{client:Vb,children:d.jsx(mx,{children:d.jsx(Bb,{})})})})}));export{mv as A,rE as B,yv as C,lE as D,gv as E,wv as F,Df as G,Ks as H,uE as I,Ct as J,cc as K,rj as L,pE as M,yE as P,xE as R,sc as S,bE as T,ds as U,_d as X,L as _,SE as a,tl as b,Z as c,kE as d,fE as e,_v as f,oE as g,hE as h,nj as i,d as j,Bi as k,aE as l,tj as m,vv as n,iE as o,PE as p,xv as q,x as r,fe as s,sE as t,fd as u,IE as v,Uo as w,EE as x,Mf as y,mE as z};
